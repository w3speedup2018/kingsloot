"use strict";(self.webpackChunkjuno_shopify_template=self.webpackChunkjuno_shopify_template||[]).push([[60],{274:(e,s,t)=>{t.r(s),t.d(s,{PredictiveSearch:()=>r});var i=t(883);class r extends HTMLElement{constructor(){super(),this.element=this,this.form=(0,i.U2)(".js-search-form",this.element),this.trigger=(0,i.U2)(".js-search-trigger"),this.target=(0,i.U2)(".js-search-target"),this.close=(0,i.U2)(".js-search-close"),this.overlay=(0,i.U2)(".js-overlay"),this.header=(0,i.U2)(".js-header"),this.input=(0,i.U2)(".js-search-input",this.form),this.results=(0,i.U2)(".js-search-results",this.element),this.searchPage=(0,i.U2)(".js-search-grid"),this.page=(0,i.U2)(".js-page"),this.itemClickedTest=!1}bindEvents(){this.trigger.addEventListener("click",(()=>this.handleOpen())),this.close.addEventListener("click",(()=>this.handleClose())),this.results.addEventListener("click",(()=>{this.itemClickedTest=!0})),this.input&&this.input.addEventListener("input",(()=>{this.isInputEmpty(this.input.value)?this.results.classList.remove("is-active"):(this.predictiveSearch(this.input.value),this.results.classList.add("is-active"))})),this.page.addEventListener("click",(()=>{this.input!==document.activeElement&&this.closeSearchResults()})),this.input.addEventListener("focusin",(()=>{this.isInputEmpty(this.input.value)||(this.predictiveSearch(this.input.value),this.results.classList.add("is-active"))}))}handleOpen(){this.target.classList.remove("is-hidden"),this.close.classList.remove("is-hidden"),this.trigger.classList.add("is-hidden"),this.overlay.classList.add("is-active"),this.header.classList.add("is-top")}handleClose(){this.target.classList.add("is-hidden"),this.close.classList.add("is-hidden"),this.trigger.classList.remove("is-hidden"),this.overlay.classList.remove("is-active"),this.header.classList.remove("is-top")}closeSearchResults(){this.results.classList.contains("is-active")&&!1===this.itemClickedTest&&this.results.classList.remove("is-active")}predictiveSearch(e){fetch(`/search/suggest?q=${e}&resources[type]=product&resources[limit]=4&section_id=predictive-search`).then((e=>{if(!e.ok){const s=new Error(e.status);throw this.close(),s}return e.text()})).then((e=>{const s=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.predictiveSearchResults.innerHTML=s,this.open()})).catch((e=>{throw this.close(),e}))}getSearchResults(e){const s=e.replace(" ","-").toLowerCase();this.setLiveRegionLoadingState(),this.cachedResults[s]?this.renderSearchResults(this.cachedResults[s]):fetch(`${routes.predictive_search_url}?q=${encodeURIComponent(e)}&${encodeURIComponent("resources[type]")}=product&${encodeURIComponent("resources[limit]")}=4&section_id=predictive-search`).then((e=>{if(!e.ok){const s=new Error(e.status);throw this.close(),s}return e.text()})).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.cachedResults[s]=t,this.renderSearchResults(t)})).catch((e=>{throw this.close(),e}))}searchRender(e){let s="";e.forEach((e=>{const t=window.theme.moneyFormat.includes("{{amount_no_decimals}}")?"{{amount_no_decimals}}":"{{amount}}",i=window.theme.moneyFormat.replace(t,e.price);s+=`\n                <a href="${e.url}" class="c-product-card">\n                    <picture class="c-product-card__image  o-img__frame  o-ar  o-ar--square  js-image">\n                        <img \n                            class="o-img  o-img--cover  o-ar__item" \n                            src="${e.image}" \n                            alt="{{ object_image.alt }}" \n                            loading="lazy"\n                            width="100%"\n                            height="100%"\n                        />\n                    </picture>\n                    <div class="c-product-card__details">\n                        <h4 class="t-heading  t-font-size--zeta">\n                            ${e.title}\n                        </h4>\n                        <p class="c-product-card__price  money" data-product-id="${e.id}">\n                            ${i} <span class="c-product-card__price-vat">Incl. VAT</span>\n                        </p>\n                    </div>\n                </a>\n            `})),this.results.innerHTML=s}isInputEmpty(e){return!e||/^\s*$/.test(e)}onChange(){const e=this.input.value.trim();e.length?this.getSearchResults(e):this.close()}debounce(e,s){let t;return(...i)=>{clearTimeout(t),t=setTimeout((()=>e.apply(this,i)),s)}}}}}]);