"use strict";(self.webpackChunkjuno_shopify_template=self.webpackChunkjuno_shopify_template||[]).push([[120],{639:(t,e,i)=>{i.d(e,{Z:()=>l});var s=i(883);const a=new Map,n=new Map,o=new Map;let r=0;function h(t,e,i={}){const{root:s,rootMargin:h,threshold:l=0}=i;if(!t)return;const u=function(t){return t?o.has(t)?o.get(t):(r+=1,o.set(t,r.toString()),`${o.get(t)}_`):""}(s)+(h?`${l.toString()}_${h}`:l.toString());let c=n.get(u);c||(c=new IntersectionObserver(d,i),u&&n.set(u,c));const p={callback:e,element:t,inView:!1,observerId:u,observer:c,thresholds:c.thresholds||(Array.isArray(l)?l:[l])};return a.set(t,p),c.observe(t),p}function d(t){t.forEach((t=>{const{isIntersecting:e,intersectionRatio:i,target:s}=t,n=a.get(s);if(n&&i>=0){let s=n.thresholds.some((t=>n.inView?i>t:i>=t));void 0!==e&&(s=s&&e),n.inView=s,n.callback(s,t)}}))}const l=class{constructor(t){this.element=void 0,this.container=void 0,this.id=void 0,this.settings=void 0,this.canAutoplay=void 0,this.canHaveSound=void 0,this.isMuted=void 0,this.isPlaying=void 0,this.isReady=void 0,this.playTrigger=void 0,this.queue=void 0,this.player=void 0,this.playPromise=void 0,this.element=t,this.settings=this.element.getAttribute("data-settings"),this.canAutoplay=this.settings.includes("autoplay"),this.canHaveSound=!((/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream),this.container=(0,s.U2)(".js-video-container",t),this.id=t.getAttribute("data-id")||"",this.isMuted=this.settings.includes("muted"),this.isPlaying=!1,this.isReady=!1,this.playTrigger=t.querySelector(".js-video-trigger"),this.queue=new Set,this.createPlayer(),this._bindTrigger(),this._observeElement(),t.dispatchEvent(new CustomEvent("videoloaded"))}play(){if(!this.isPlaying)return this.isReady?void(this.playPromise=Promise.resolve(this.playVideo())):(this.createPlayer(),void this._queueTask("play"))}async pause(){this.isPlaying&&(this.isReady&&void 0!==this.playPromise?(await this.playPromise,this.pauseVideo(),this.onStop()):this._queueTask("pause"))}onEnded(){this.onStop()}onPlay(){this.element.setAttribute("data-status","loaded playing"),this.isPlaying=!0}onStop(){this.element.setAttribute("data-status","loaded paused"),this.isPlaying=!1}watchResize(t,e){const i=e/t,s=()=>{const t=this.element.clientWidth;this.container.style.width=`${t}px`,this.container.style.height=t*i+"px"};s(),this.element.dispatchEvent(new CustomEvent("videosize")),window.dispatchEvent(new CustomEvent("resize")),window.addEventListener("resize",(()=>s())),this.player.element.setAttribute("tabindex","-1")}flushQueue(){this.queue.forEach((t=>this[t]())),this.queue.clear()}_queueTask(t){this.queue.add(t)}_bindTrigger(){this.playTrigger&&this.playTrigger.addEventListener("click",(()=>{this.isPlaying?this.pause():this.play()}))}_observeElement(){h(this.container,(t=>{t&&this.canAutoplay?this.play():this.isReady&&this.pause()}),{threshold:.25,rootMargin:"-50px"})}}},896:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});var s=i(639);class a extends s.Z{constructor(...t){super(...t),this.player=void 0}createPlayer(){if(this.player)return;let t,e=[];this.container.hasAttribute("data-sources")?(t=JSON.parse(this.container.getAttribute("data-sources")),e=t.sources):this.container.hasAttribute("data-url")&&e.push({mime_type:"video/mp4",url:this.container.getAttribute("data-url")}),this.container.innerHTML=`\n            <video muted playsinline loop controls width="100%" height="100%">\n                ${e.reduce(((t,e)=>t+=`<source src="${e.url}" type="${e.mime_type}">`),"")}\n            </video>\n        `;const i=this.container.firstElementChild;i.element=this.container.firstElementChild,i.addEventListener("canplay",(()=>this._onReady(i))),i.addEventListener("ended",(()=>this.onEnded())),i.addEventListener("play",(()=>this.onPlay())),i.addEventListener("pause",(()=>this.pause()))}playVideo(){this.player.play()}pauseVideo(){this.player.pause()}_onReady(t){this.player=t,this.isReady=!0;const{videoWidth:e,videoHeight:i}=this.player;this.watchResize(e,i),"requestIdleCallback"in window?requestIdleCallback((()=>this.flushQueue())):this.flushQueue()}}const n=a}}]);